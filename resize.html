<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Redimensionner et déplacer avec SVG</title>
  <style>
    #svg-container {
      border: 1px solid #ddd;
      margin: 20px;
      position: relative;
    }
    .resizer {
      fill: red;
      cursor: pointer;
      display: none; /* Les points sont cachés par défaut */
    }
    .active .resizer {
      display: block; /* Les points sont affichés lorsque le carré est actif */
    }
  </style>
</head>
<body>
  <div id="svg-container">
    <svg id="svg" width="500" height="500">
      <!-- Carré -->
      <rect id="square" x="50" y="50" width="100" height="100" fill="blue" />
      
      <!-- Points de redimensionnement -->
      <circle id="top-left" cx="50" cy="50" r="5" class="resizer" />
      <circle id="top-right" cx="150" cy="50" r="5" class="resizer" />
      <circle id="bottom-left" cx="50" cy="150" r="5" class="resizer" />
      <circle id="bottom-right" cx="150" cy="150" r="5" class="resizer" />
    </svg>
  </div>
  <script>
    document.addEventListener('DOMContentLoaded', () => {
  const svgContainer = document.getElementById('svg-container');
  const square = document.getElementById('square');
  const resizers = document.querySelectorAll('.resizer');
  
  let selectedResizer = null;
  let startX, startY, startWidth, startHeight, startCX, startCY;

  function updateResizers() {
    const x = parseFloat(square.getAttribute('x'));
    const y = parseFloat(square.getAttribute('y'));
    const width = parseFloat(square.getAttribute('width'));
    const height = parseFloat(square.getAttribute('height'));

    document.getElementById('top-left').setAttribute('cx', x);
    document.getElementById('top-left').setAttribute('cy', y);

    document.getElementById('top-right').setAttribute('cx', x + width);
    document.getElementById('top-right').setAttribute('cy', y);

    document.getElementById('bottom-left').setAttribute('cx', x);
    document.getElementById('bottom-left').setAttribute('cy', y + height);

    document.getElementById('bottom-right').setAttribute('cx', x + width);
    document.getElementById('bottom-right').setAttribute('cy', y + height);
  }

  function startResize(evt) {
    selectedResizer = evt.target;
    startX = evt.clientX;
    startY = evt.clientY;
    startWidth = parseFloat(square.getAttribute('width'));
    startHeight = parseFloat(square.getAttribute('height'));
    startCX = parseFloat(selectedResizer.getAttribute('cx'));
    startCY = parseFloat(selectedResizer.getAttribute('cy'));

    document.addEventListener('mousemove', resize);
    document.addEventListener('mouseup', stopResize);
  }

  function resize(evt) {
    const dx = evt.clientX - startX;
    const dy = evt.clientY - startY;

    let newWidth = startWidth;
    let newHeight = startHeight;
    let newX = parseFloat(square.getAttribute('x'));
    let newY = parseFloat(square.getAttribute('y'));

    if (selectedResizer.id === 'top-left') {
      newWidth = startWidth - (evt.clientX - startCX);
      newHeight = startHeight - (evt.clientY - startCY);
      newX = evt.clientX;
      newY = evt.clientY;
    } else if (selectedResizer.id === 'top-right') {
      newWidth = startWidth + (evt.clientX - startCX);
      newHeight = startHeight - (evt.clientY - startCY);
      newY = evt.clientY;
    } else if (selectedResizer.id === 'bottom-left') {
      newWidth = startWidth - (evt.clientX - startCX);
      newHeight = startHeight + (evt.clientY - startCY);
      newX = evt.clientX;
    } else if (selectedResizer.id === 'bottom-right') {
      newWidth = startWidth + (evt.clientX - startCX);
      newHeight = startHeight + (evt.clientY - startCY);
    }

    newWidth = Math.max(newWidth, 10);
    newHeight = Math.max(newHeight, 10);

    square.setAttribute('width', newWidth);
    square.setAttribute('height', newHeight);
    square.setAttribute('x', newX);
    square.setAttribute('y', newY);

    updateResizers();
  }

  function stopResize() {
    document.removeEventListener('mousemove', resize);
    document.removeEventListener('mouseup', stopResize);
  }

  // Affichage des points de redimensionnement lors de la sélection
  svgContainer.addEventListener('click', (evt) => {
    if (evt.target === square) {
      svgContainer.classList.toggle('active');
      updateResizers();
    } else if (svgContainer.classList.contains('active')) {
      svgContainer.classList.remove('active');
    }
  });

  // Ajouter des événements de redimensionnement pour chaque point
  resizers.forEach(resizer => {
    resizer.addEventListener('mousedown', startResize);
  });

  // Initialiser les points de redimensionnement
  updateResizers();
});

  </script>
</body>
</html>
